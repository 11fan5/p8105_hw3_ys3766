---
title: "p8105_hw3_ys3766"
author: "Yifan Shi"
date: "2024-10-13"
output: github_document
---
```{r set up, include=FALSE}
library(tidyverse)
library(ggridges)
library(patchwork)
library(p8105.datasets)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

Problem 1
```{r}
data("ny_noaa")
```

This dataset contains a total of 'r nrow(ny_noaa)' rows and 'r ncol(ny_noaa)' columns. The dataset consists of variables on weather station ID, date of observation, precipitation (tenths of mm), snowfall (mm), snow depth (mm), and minimum and maximum temperature (tenths of degrees C). 

```{r}
ny_noaa %>% 
  count(snow) %>% 
  arrange(desc(n))
```

```{r}
ny_noaa = 
  ny_noaa %>% 
  separate(date, into = c("year", "month", "day"), convert = TRUE) %>% 
  mutate(
    tmax = as.numeric(tmax),
    tmin = as.numeric(tmin)
  )
```

I then cleaned the data by creating separate variables for year, month and day from the date variable. I also converted the tmin and tmax to numeric. The most commonly observed snowfall value is 0, because for most days in year there are no snowfall. It is followed by NA which has 381221 entiries, which indicates that missing values is a concern. 

Plot
```{r}
ny_noaa %>% 
  group_by(id, year, month) %>% 
  filter (month %in% c(1, 7)) %>% 
  summarize (mean_tmax = mean(tmax, na.rm = TRUE, color = id)) %>% 
  ggplot(aes(x = year, y = mean_tmax, group = id)) + 
  geom_point()+
  geom_path()+
  facet_grid(~month)+
  labs(title = "Average maximum temperature in January and July for each station across years")

```

The above plot shows the average maximum temperature in January and July in each station across years. The average temperature is high in July than in January, as the stations are in the Northern Hemisphere. All stationss are following similar trends of temperature peaks and valleys. In July 1987, there is one outlier where that station is much colder than other stations. Similarly in January 1982 and 2005 there are outliers with much colder temperature. 

```{r}
hexplot = ny_noaa %>% 
  ggplot(aes(x = tmin, y = tmax))+
  geom_hex(
  )

ridgeplot = ny_noaa %>% 
  filter (snow < 100, snow >0) %>% 
  ggplot(aes(x=snow, y=as.factor(year)))+
  geom_density_ridges()

hexplot + ridgeplot
```

The above plots show a hex plot of the tmax vs tmin for the full dataset and a ridge plot of the distribution of snowfall (mm) greater than 0 and less than 100 by year. The hex plot show that the majority of the data cluster tightly in the center of the distribution. Some tmax is lower than the tmin, which should not have happened and might be an error in data collection. The ridge plot shows multimodal density of snowfall within a given year. Most stations records 0-35mm of snow in a year, and another cluster of stasion see 45mm of snow, and another group see around 78mm of snow. This is likele due to the conversion from inch to metric, as 1 inch=25.4mm







